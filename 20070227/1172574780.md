---
Title: ' アドレス帳データをテンプレートに定義できるプラグイン'
Category:
- becky2
Date: 2007-02-27T20:13:00+09:00
URL: http://tkatochin.hatenablog.com/entry/20070227/1172574780
EditURL: https://blog.hatena.ne.jp/t-katochin/tkatochin.hatenablog.com/atom/entry/6653586347154755615
---

　重い腰あげてサクっと作成。[http://sites.google.com/site/tkatochin/home/programs/TemplateExtendPlugin.zip:title=→ダウンロード←]
**概要
　アドレス帳の情報を、メールテンプレートに定義することができるプラグインです。

**テンプレートの書式
　テンプレート文字列としては、Becky標準の %X という書式ではなく、以下の書式になります。
>||
$To(宛先インデックス){キー}
||<
　宛先インデックスは、例えば１人目は $To(0)、２人目は $To(1) のようになります。省略することもできます。省略した場合は、$To(0) と同じです。
　キーは、VCARDのキーになります。メールボックスにあるアドレス帳のファイルを参照すると、どのようなキーワードがあるか判ります。アドレス帳のファイルは、Beckyメールフォルダの下の AddrBookディレクトリ内に*.babで検索すると見つかります。VCARDは、:で区切られた左側がキー、右側がデータになります。データの中は ; で区切られた複数要素を持つ場合があります。例えば以下のようにデータが保存されています。
>||
N:柴田;勝家;権六
EMAIL;PREF:shibata@gon.roku
ORG:尾張国;愛知郡;
||<
　EMAIL;PREFはメールアドレスです。宛先のメールアドレスにマッチするアドレス情報プロパティからデータが展開されます。データが ;で区切られている場合は、キー(値インデックス) と指定することで一部を取り出すことができます。以下にテンプレートの例と、実行結果の例を示します。
>||
$To{ORG(0)}
$To{ORG(1)}
$To{N(0)}$To{N(2)}$To{N(1)} 様
||<
>||
尾張国
愛知郡
柴田権六勝家 様
||<
　VCARDにはカスタム項目を追加できるので、人によって敬称や挨拶文を変えるといった応用もできるでしょう。（VCARDの使い方としては正しくないのかもしれませんが。）
**インストールの仕方
　書庫に含まれている、TemplateExtendPlugin.dllを、Becky2のインストールディレクトリ直下のPluginsフォルダにコピーして、Becky2を再起動してください。
**利用上の注意
- GPLライセンスとします。改良は自由です。再配布も自由です。これを使って何か問題が起きても当方は一切の責任を負いません。利用は自己責任でお願いします。
**謝辞
- Becky! Plug-in SDK for Delphi の Ryota Ando氏に感謝します。
- ファイル検索コンポーネント の Black Monkey氏に感謝します。
**既知の問題点
- 値に半角スペースがあるとそれ以降は表示されません。当面全角スペースを使ってください。
- アドレス帳データの備考はエンコードされているがデコードしていません。
:作成者:かとちん（http://d.hatena.ne.jp/t-katochin/）
