---
Title: ' スプレッドシートで本当に隠しておきたいもの付きで配布'
Category:
- apps
Date: 2011-09-07T20:53:45+09:00
URL: http://tkatochin.hatenablog.com/entry/20110907/1315396425
EditURL: https://blog.hatena.ne.jp/t-katochin/tkatochin.hatenablog.com/atom/entry/6653586347154753016
---

　スプレッドシートに共同編集者を設定はしたいがオーナー以外には隠しておきたい情報がある場合、スクリプトプロジェクトの共有を「ドキュメントの共同編集者にプロジェクトの編集を許可する」のチェックは付けないようにしておく。
　こうするとオーナー以外はスクリプトエディタを開いて[ファイル]-[プロパティ]を開いても、「プロジェクトのプロパティ」を見ることができない。「ユーザープロパティ」しか見えない。この情報はコード内から、ScriptPropertiesサービスで参照できるのでスクリプトコードにハードコードしないようにすれば良さげ。例えば、[http://nakajiman.blogspot.com/2011/03/google-apps-script-urlfetch-services.html:title=なかじまんさんがApps Scriptで2Legged OAuthを実現させていた]ので、consumerKeyとconsumerSecretをScriptPropertiesに保存しておくのが良い使い方かも。
　…と思ってたんだけど、複製したらプロパティの内容は消失することが判明。残念。
　コピーを作成で複製すると、プロジェクトも一緒に複製されるので、リードオンリーだった共同編集者も複製したものであれば編集できるようになる((タイムラグがあるようで、複製後いきなりスクリプトコードエディタを開くと空っぽになっていることが多い。時間が経つと複製されたプロジェクトが見える))。
　サービス公開を有効にして外からプロパテイを流しこむという手もあるんだけど、「サービス公開を有効に」するAPIが無さそう。やりたいことはDocument List APIで複製したスプレッドシートに対してプログラムから操作したいので...
　ちなみにサービスとして公開というのは、doGet(e) をメソッドして定義しておけば呼び出してくれるというもの。[http://blog.hikozaru.com/2010/11/hello-world.html:title=こちら]が参考になった。本家は[http://code.google.com/intl/ja/googleapps/appsscript/guide_user_interfaces.html#RunDecision:title=こちら]。
　しかし実行してみたら...オワタ
>>
Google ドキュメントでサーバー エラーが発生しました。ページをリロードしても解決しない場合は、お問い合わせください。

この問題やその他の問題についてディスカッションするには、Google ドキュメント ヘルプフォーラムにアクセスしてください。報告されている問題のリストを確認するには、Google ドキュメントの報告されている問題ページをご覧ください。


ご不便をおかけして申し訳ありません。
- Google Docs チーム
<<
***追記(9/8)
…って、違う違う。終わってない。ScriptPropertiesサービスを触るコードを書いたら上記のエラー画面になっただけでした。そういう意味では、サーブレットとして実行する場合に利用出来るサービスが何なのかが分からないと辛いですねー。
