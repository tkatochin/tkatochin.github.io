---
Title: ' 日本語入力モードの切り替えが突然できなくなった'
Category:
- PC環境
Date: 2008-05-21T16:09:12+09:00
URL: http://tkatochin.hatenablog.com/entry/20080521/1211353752
EditURL: https://blog.hatena.ne.jp/t-katochin/tkatochin.hatenablog.com/atom/entry/6653586347154754767
---

　VISTAが突然、[半角／全角]キーでも[かな]キーでも、英字入力のまま。マウスで言語バー操作する以外にモード切替できなくなった。IMEの設定を見てもキーバインドの変更はないしなんじゃこりゃ。
　直前にPowerPointViewerをインストールした以外に何か変更した覚えなし。
　[http://salv.miscnotes.com/2007/02/ime2007.php:title=こちら]も試したけど解決しない。[Alt]+[半角／全角]キーでも効かない。再起動しても勿論治らない。どうなってるんでしょ。
　[http://support.microsoft.com/kb/932102/ja:title=こちら]も関係なかった。辞書を修復しても、「標準にもどす」で初期状態にリセットしても変化なし。[Alt]+[かな]によるローマ字入力、かな入力切り替えもXPでは問題ないけど、Vistaでは無反応。Synergyを切っても同じ。

　思い出した！これ以外に今日、Windows Updateのアイコンが通知領域にあって、「Vistaの重要な更新（＋グループポリシーのなんだったかの更新）KB943729」をインストールしたんだった。アンインストールしてみる…それでも復旧しない。
　他のキー（CTRL+SPACE）に、IME ON/OFFを割り当ててみたところ、これは動作した。ということは、かなキーも漢字キーも存在しないキーボードレイアウト扱いになっているんじゃないか？BootCampのドライバがおかしくなったのかな？
　最後の手段。今日Windows Updateによって作成された復元ポイントよりも過去の復元ポイントに戻す。…が、解決せず。orz

　[http://d.hatena.ne.jp/ruzia/20071028/1193557220:title=こちらの情報]が該当した。AppkeキーボードからでもSynergyからでも[Shift]+[Caps]であれば、入力モードが変わる！完全にUSキーボード扱いになっているってことじゃん！なぜ！？
　たしかに、[http://hidelafoglia.livejournal.com/25114.html:title=こちらの情報]でいうところの「だめなやつ」の方になっている。「対応したやつ」を見てレジストリを修正してもダメだった。手元のVistaではi8042prtキーのしたにEnumキーがないからか？

　やっと治った！以下を実行した。

-デバイスマネージャを開く
-[ヒューマンインターフェイスデバイス]-[Apple Keyboard] が２つあり、最初の方を開いて「ドライバを元に戻す」を実行。
しかし[ALT]+[半角／全角]じゃないとダメになった。

***追記
　うーん、[ALT]+[半角／全角]じゃないとだめになった。以前からこうだった記憶はないんだけど。記憶違いかな……。
　ドライバの更新をしても前のように[ALT]+[半角／全角]も認識しない…ということはなくなった。

***さらに追記
　ようやく原因判明。昨日Vistaじゃない側のsynergyをja版じゃないもの(SynergyInstaller-1.3.1.exe)で更新してしまっていたからだった〜！！わいはアホや。ほんまもんのアホや。orz
　SynergyInsataller-1.3.1-ja.exeをダウンロードしなおして再インストール。[半角／全角]だけで入力できるようになりました。
　
