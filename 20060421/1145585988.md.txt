---
Title: ' 保存データ'
Category:
- JMeter
Date: 2006-04-21T11:19:48+09:00
URL: http://tkatochin.hatenablog.com/entry/20060421/1145585988
EditURL: https://blog.hatena.ne.jp/t-katochin/tkatochin.hatenablog.com/atom/entry/6653586347154755987
---

　結果データの保存／復元のUIが分かりにくいし使いにくい。たとえばテスト結果に対して「名前を付けて保存する」なんてことはできない。保存するためにはテスト実行前から各リスナ画面の「全てのデータをファイルに出力」という欄に保存ファイル名を指定しておかないとならない。他の方法はないかとリスナを右クリしたところ「SaveAsImage」というメニューが出たので「これか〜」と思って保存したが画面上で見えているハードコピーを保存するだけだった。スプリッタを左に引っ張って目一杯広げても、テスト項目やテスト時間が長いとテスト結果画面にはスクロールバーがついていて全部のデータは見れない。ALT+PrintScreenとなんも変わらん。いらなすぎる。
　それ以上にはまったのはファイルの復元の仕方。ファイルメニューの「開く」ではテスト計画全体のファイルしか選択できない。対象リスナのノードを右クリックすると「開く」があるのでこれかな？と思ったがやはりテスト計画全体になる。その際「保存されていないテスト項目があります。テスト計画を消去する前に保存しますか？」と聞いてくるが「はい」「いいえ」しかなく、キャンセルできない。どちらを選んでも一旦ご破算に（しかも後述するがデータが正しく復元できないのでうっかり選ぶとかなり致命的）。ひどすぎる。
　ようやく分かったのだがヘナヘナになった。同じ形式のリスナ画面で、さきほど説明した「全てのデータをファイルに出力」という欄から再度「参照」ボタンでファイル名を指定するのだ。出力だけではなく入力も兼ねていたのだ。しかもこれで読み込めはしたもののうっかりテストを開始するとこのファイルに記録されてしまうのでタチが悪い。
　テスト計画のファイルの復元の仕方もひどい。テスト計画を保存して開きなおすと、リスナの中は空っぽになっている。しかし出力ファイル名の欄は前回と同じだ。一瞬データファイルが消去されたのかとビビったが物理ファイルは残っていた。で、データの読み込み方だが、その入力欄でENTERを押したら読み込まれた。もしくは[参照]で同じファイル名を指定しなおすと読み込まれる。なんのこっちゃ。
　しかしUIはともかく最悪なのは保存したデータをちゃんと復元できないこと。統計レポートは合計行の前で「Error loading results file - ses log file」なんてすでにURLじゃないタイトルの行が。スループットは無限大/secになっているし。そのせいで合計がちゃんと計算できていない。
書かれているとおり、ses log file (JMETER_HOME/bin/jmeter.log)してみると、以下のようなのが。
>>
jmeter.reporters.ResultCollector: File load failure, trying old data format.
<<
古いフォーマットで試せ…って、どうやったらそんなことができるのかと。そもそももう保存しちゃったものは変えようが無いでしょう。ふと、エクスプローラを見ると、そのログファイルの横に jmeter.propertiesがあった。中を見たところ、どうやらデータファイルのフォーマットを設定することができそうだということが分かった（もう７割方信じていないが）。
>|jproperties|
#File format for saved test files.  JMeter 2.1 uses a new format. Set value to 2.0 to save to old
# format
# Save test plans and test logs in 2.0 format
#file_format=2.0
# Just test plans (jmx)
#file_format.testplan=2.0
# Just test logs (jtl)
file_format.testlog=2.0
||<
　よく分からないが一言いってもいいかな。<big>最初からold formatやんけ〜！！</big>
とりあえず新しいフォーマットになることを期待してコメントアウトして様子見。結果はまた今度。
